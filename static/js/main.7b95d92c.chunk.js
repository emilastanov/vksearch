(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{119:function(e,t,a){"use strict";a.r(t);a(67),a(92);var n=a(0),o=a.n(n),s=a(39),l=a.n(s),r=a(9),i=a.n(r),c=a(28),d=a(17),p=a(18),h=a(20),u=a(19),m=a(21),E=a(1),g=(a(118),a(61)),v=a.n(g),f=a(62),y=a.n(f),b=a(63),k=a.n(b),S=a(64),w=a.n(S),C=a(65),x=a.n(C),O=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={adult:0,q:"",contextOpened:!1,hd:0,longer:0,count:10,sort:2},a.searchVideo=function(e){"Enter"===e.key&&(a.setState({count:10}),a.props.updateHistory(a.state.q),a.props.loading(),a.props.connect.send("VKWebAppCallAPIMethod",{method:"video.search",params:{sort:a.state.sort,hd:a.state.hd,longer:a.state.longer,count:10,q:a.state.q,adult:a.state.adult,v:"5.95",access_token:a.props.data.token}}))},a.searchOffset=function(){a.props.loading(),a.props.connect.send("VKWebAppCallAPIMethod",{method:"video.search",params:{sort:a.state.sort,hd:a.state.hd,longer:a.state.longer,count:a.state.count+10,q:a.state.q,adult:a.state.adult,v:"5.95",access_token:a.props.data.token}}),a.setState({count:a.state.count+10})},a.searchVideoFromHistory=function(e){a.setState({q:e}),a.props.loading(),a.props.connect.send("VKWebAppCallAPIMethod",{method:"video.search",params:{sort:a.state.sort,hd:a.state.hd,longer:a.state.longer,count:a.state.count,q:e,adult:a.state.adult,v:"5.95",access_token:a.props.data.token}})},a.toggleContext=function(){a.setState({contextOpened:!a.state.contextOpened})},a.searchSort=function(e){a.setState({count:10,sort:e}),a.props.loading(),a.props.connect.send("VKWebAppCallAPIMethod",{method:"video.search",params:{sort:e,hd:a.state.hd,longer:a.state.longer,count:10,q:a.state.q,adult:a.state.adult,v:"5.95",access_token:a.props.data.token}})},a}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(E.Panel,{id:this.props.id},o.a.createElement(E.PanelHeader,null,o.a.createElement(E.PanelHeaderContent,{aside:o.a.createElement(k.a,null),onClick:this.toggleContext},"\u0412\u0438\u0434\u0435\u043e")),o.a.createElement(E.HeaderContext,{opened:this.state.contextOpened,onClose:this.toggleContext},o.a.createElement(E.List,null,o.a.createElement(E.Cell,null,o.a.createElement(E.Checkbox,{onChange:function(){e.setState({adult:1-e.state.adult%2}),e.searchSort(2)},checked:!this.state.adult},"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a"),o.a.createElement(E.Checkbox,{onChange:function(){e.setState({hd:1-e.state.hd%2}),e.searchSort(2)},checked:this.state.hd},"\u0422\u043e\u043b\u044c\u043a\u043e \u0432\u044b\u0441\u043e\u043a\u043e\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"),o.a.createElement(E.Checkbox,{onChange:function(){e.setState({longer:0===e.state.longer?600:0}),e.searchSort(2)},checked:(this.state.longer-this.state.longer%600)/600},"\u0422\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u0438\u043d\u043d\u044b\u0435")))),o.a.createElement(E.Search,{onChange:function(t){e.setState({q:t})},value:this.state.q,onKeyPress:this.searchVideo,onClick:this.props.clearSR,autoComplete:!0}),this.props.data.loading?o.a.createElement(E.Spinner,{style:{marginTop:15,matginBottom:15}}):null,o.a.createElement(E.List,null,this.props.data.sR?this.props.data.sR.map(function(t,a){var n=t.owner_id,s=t.id;return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("a",{href:"https://vk.com/video".concat(n,"_").concat(s),key:a},o.a.createElement(E.Cell,null,o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",{style:{position:"relative"}},o.a.createElement("img",{src:t.photo_130,alt:"pic",style:{width:140}}),o.a.createElement("h5",{style:{color:"#E6E6E6",margin:0,position:"absolute",bottom:2,right:2}},Math.floor(t.duration/60),":",t.duration%60<10?"0"+t.duration%60:t.duration%60)),o.a.createElement("td",{style:{width:"70%",position:"relative",height:"100%"},valign:"top"},o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,marginTop:0,marginBottom:4,textSize:15}},t.title),o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,marginTop:0,textSize:11,color:"#939393"}},t.description),o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,margin:1,textSize:8,color:"#939393",position:"absolute",bottom:2}},"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u044b: ",t.views)))))),o.a.createElement("hr",{style:{display:"none"}})),o.a.createElement("div",{id:a,style:{position:"absolute",right:10,bottom:10,color:"#4e7097",zIndex:10},onClick:function(o){e.props.updateList([{owner_id:n,id:s,photo_130:t.photo_130,duration:t.duration,title:t.title,description:t.description,views:t.views}]),document.getElementById(a).innerHTML="\u2713"}},o.a.createElement(x.a,null)))}):this.props.data.history?this.props.data.history.split(",").slice(1).reverse().map(function(t,a){return o.a.createElement(E.Cell,{key:a,onClick:function(){e.searchVideoFromHistory(t)}},t)}):null,!this.props.data.sR&&this.props.data.history?o.a.createElement(E.Div,null,o.a.createElement(E.Button,{align:"center",size:"xl",onClick:this.props.clearHistory},"\u041e\u0442\u0447\u0438\u0441\u0442\u0438\u0442\u044c")):null),this.props.data.loading&&this.props.data.sR?o.a.createElement(E.Spinner,{style:{marginTop:15,matginBottom:15}}):null,this.props.data.sR?o.a.createElement(E.Div,null,o.a.createElement(E.Button,{align:"center",size:"xl",onClick:function(){e.searchOffset()},before:this.props.data.loading&&this.props.data.sR?o.a.createElement(E.Spinner,{style:{marginTop:15,matginBottom:15}}):o.a.createElement(w.a,null)},"\u0415\u0449\u0435")):null,o.a.createElement(E.Footer,null,"\u041f\u043e\u0438\u0441\u043a \u0432\u0438\u0434\u0435\u043e"),this.props.data.sR?o.a.createElement(E.FixedLayout,{vertical:"bottom",style:{zIndex:12}},o.a.createElement(E.Tabs,null,o.a.createElement(E.TabsItem,{selected:2===this.state.sort,onClick:function(){e.searchSort(2)}},"\u041f\u043e \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u043e\u0441\u0442\u0438"),o.a.createElement(E.TabsItem,{selected:0===this.state.sort,onClick:function(){e.searchSort(0)}},"\u041f\u043e \u0434\u0430\u0442\u0435"),o.a.createElement(E.TabsItem,{selected:1===this.state.sort,onClick:function(){e.searchSort(1)}},"\u041f\u043e \u0434\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438"))):null)}}]),t}(o.a.Component),A=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).updateStore=function(e){var t=a.props.data.list.concat(e);a.props.connect.send("VKWebAppCallAPIMethod",{method:"storage.set",params:{key:"mylist",value:t,v:"5.95",access_token:a.props.data.token}})},a}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return o.a.createElement(E.Panel,{id:this.props.id,style:{position:"relative"}},o.a.createElement(E.PanelHeader,null,"\u0413\u0430\u043b\u0435\u0440\u0435\u044f"),o.a.createElement(E.List,null,this.props.data.list?this.props.data.list.map(function(e,t){return o.a.createElement("a",{href:"https://vk.com/video".concat(e.owner_id,"_").concat(e.id),key:t},o.a.createElement(E.Cell,null,o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",{style:{position:"relative"}},o.a.createElement("img",{src:e.photo_130,alt:"pic",style:{width:140}}),o.a.createElement("h5",{style:{color:"#E6E6E6",margin:0,position:"absolute",bottom:2,right:2}},Math.floor(e.duration/60),":",e.duration%60<10?"0"+e.duration%60:e.duration%60)),o.a.createElement("td",{style:{width:"70%",position:"relative",height:"100%"},valign:"top"},o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,marginTop:0,marginBottom:4,textSize:15}},e.title),o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,marginTop:0,textSize:11,color:"#939393"}},e.description),o.a.createElement("p",{style:{overflow:"hidden",textOverflow:"ellipsis",width:240,margin:1,textSize:8,color:"#939393",position:"absolute",bottom:2}},"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u044b: ",e.views)))))),o.a.createElement("hr",{style:{display:"none"}}))}):null))}}]),t}(o.a.Component),I=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(h.a)(this,Object(u.a)(t).call(this,e))).clearSR=function(){a.setState({sR:null})},a.updateHistory=function(e){a.setState({history:a.state.history+","+e}),localStorage.setItem("history",a.state.history+","+e,{path:"/"})},a.clearHistory=function(){a.setState({history:""}),localStorage.removeItem("history")},a.loading=function(){a.setState({loading:!a.state.loading})},a.updateList=function(e){a.setState({list:a.state.list.concat(e)})},a.setPanel=function(e){a.setState({activePanel:e})};var n=e.cookies;return a.state={activePanel:"home",fetchedUser:null,token:n.get("userToken"),console:null,sR:null,loading:!1,history:localStorage.getItem("history")||"",list:[]},console.log(),a}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;i.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:t.detail.data});break;case"VKWebAppAccessTokenReceived":e.props.cookies.set("userToken",t.detail.data.access_token,{path:"/"}),e.setState({token:t.detail.data.access_token});break;case"VKWebAppCallAPIMethodResult":t.detail.data.response.count?(e.setState({sR:t.detail.data.response.items}),e.loading()):console.log(e.state.list);break;default:e.setState({console:t.detail.type})}}),this.state.token||i.a.send("VKWebAppGetAuthToken",{app_id:6960579,scope:"friends,video"}),i.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){var e=this;return this.state.fetchedUser?o.a.createElement(E.Epic,{activeStory:"search",tabbar:o.a.createElement(E.Tabbar,null,o.a.createElement(E.TabbarItem,{selected:"home"===this.state.activePanel,onClick:function(){e.setPanel("home")}},o.a.createElement(v.a,null)),o.a.createElement(E.TabbarItem,{onClick:function(){e.setPanel("list")},selected:"list"===this.state.activePanel},o.a.createElement(y.a,null)))},o.a.createElement(E.View,{id:"search",activePanel:this.state.activePanel},o.a.createElement(O,{id:"home",data:this.state,connect:i.a,loading:this.loading,updateHistory:this.updateHistory,clearSR:this.clearSR,clearHistory:this.clearHistory,updateList:this.updateList}),o.a.createElement(A,{id:"list",connect:i.a,data:this.state}))):o.a.createElement("h1",{align:"center"},"Unsupported device!")}}]),t}(o.a.Component),P=Object(c.b)(I);i.a.send("VKWebAppInit",{}),l.a.render(o.a.createElement(c.a,null,o.a.createElement(P,null)),document.getElementById("root"))},66:function(e,t,a){e.exports=a(119)}},[[66,1,2]]]);
//# sourceMappingURL=main.7b95d92c.chunk.js.map